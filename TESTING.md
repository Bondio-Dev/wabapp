# üß™ –ò–ù–°–¢–†–£–ö–¶–ò–Ø –ü–û –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Æ MVP

## üè† –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ localhost

### 1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞
```bash
# –†–∞—Å–ø–∞–∫—É–π—Ç–µ –∞—Ä—Ö–∏–≤
unzip whatsapp-amo-mvp.zip
cd whatsapp-amo-mvp

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
npm install

# –ù–∞—Å—Ç—Ä–æ–π—Ç–µ .env –¥–ª—è localhost
cp .env.example .env
nano .env
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è localhost
–í —Ñ–∞–π–ª–µ `.env` —É–∫–∞–∂–∏—Ç–µ:
```env
NODE_ENV=development
PORT=3001
AMO_REDIRECT_URI=http://localhost:3001/api/amo/callback

# –û—Å—Ç–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–∞–∫ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞
GUPSHUP_API_KEY=–≤–∞—à_–∫–ª—é—á
AMO_SUBDOMAIN=–≤–∞—à_–ø–æ–¥–¥–æ–º–µ–Ω
# ...
```

### 3. –ó–∞–ø—É—Å–∫
```bash
# –†–∞–∑—Ä–∞–±–æ—Ç—á–µ—Å–∫–∏–π —Ä–µ–∂–∏–º —Å –∞–≤—Ç–æ–ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–æ–º
npm run dev

# –ò–ª–∏ –æ–±—ã—á–Ω—ã–π –∑–∞–ø—É—Å–∫
npm start
```

### 4. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ localhost
- **–í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å:** http://localhost:3001
- **API Health:** http://localhost:3001/health
- **OAuth amoCRM:** http://localhost:3001/api/amo/auth

---

## üåê –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ —Ä–µ–∞–ª—å–Ω–æ–º —Å–µ—Ä–≤–µ—Ä–µ (83.166.238.230)

### 1. –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä
```bash
# –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∞—Ä—Ö–∏–≤ –Ω–∞ —Å–µ—Ä–≤–µ—Ä
scp whatsapp-amo-mvp.zip root@83.166.238.230:/opt/

# –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ —Å–µ—Ä–≤–µ—Ä—É
ssh root@83.166.238.230
```

### 2. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
```bash
cd /opt
unzip whatsapp-amo-mvp.zip
cd whatsapp-amo-mvp

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Node.js –µ—Å–ª–∏ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
curl -fsSL https://deb.nodesource.com/setup_18.x | sudo -E bash -
sudo apt-get install -y nodejs

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
npm install
```

### 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è —Ä–µ–∞–ª—å–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞
```bash
cp .env.example .env
nano .env
```

–£–∫–∞–∂–∏—Ç–µ –≤ `.env`:
```env
NODE_ENV=production
PORT=3001
AMO_REDIRECT_URI=http://83.166.238.230:3001/api/amo/callback

GUPSHUP_API_KEY=–≤–∞—à_–∫–ª—é—á_gupshup
GUPSHUP_APP_NAME=–∏–º—è_–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
AMO_SUBDOMAIN=–≤–∞—à_–ø–æ–¥–¥–æ–º–µ–Ω
AMO_CLIENT_ID=–≤–∞—à_client_id
AMO_CLIENT_SECRET=–≤–∞—à_—Å–µ–∫—Ä–µ—Ç
```

### 4. –ó–∞–ø—É—Å–∫ –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ
```bash
# –ß–µ—Ä–µ–∑ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π —Å–∫—Ä–∏–ø—Ç
./start.sh

# –ò–ª–∏ –Ω–∞–ø—Ä—è–º—É—é —á–µ—Ä–µ–∑ PM2
npm install -g pm2
npm run pm2

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
pm2 status
pm2 logs
```

### 5. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∞–ª—å–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞
- **–í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å:** http://83.166.238.230:3001
- **API Health:** http://83.166.238.230:3001/health
- **OAuth amoCRM:** http://83.166.238.230:3001/api/amo/auth

---

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤–Ω–µ—à–Ω–∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤

### Gupshup Webhook
–í –ø–∞–Ω–µ–ª–∏ Gupshup —É–∫–∞–∂–∏—Ç–µ webhook URL:
- **Localhost:** http://localhost:3001/webhook/gupshup *(—Ç–æ–ª—å–∫–æ –¥–ª—è —Ç–µ—Å—Ç–æ–≤)*
- **–°–µ—Ä–≤–µ—Ä:** http://83.166.238.230:3001/webhook/gupshup

### amoCRM Redirect URI
–í –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ amoCRM:
- **Localhost:** http://localhost:3001/api/amo/callback
- **–°–µ—Ä–≤–µ—Ä:** http://83.166.238.230:3001/api/amo/callback

---

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–æ—á–Ω—ã–µ —Ç–µ—Å—Ç—ã

### 1. Health Check
```bash
curl http://83.166.238.230:3001/health
# –î–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å status: "OK"
```

### 2. –û—Ç–ø—Ä–∞–≤–∫–∞ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è
```bash
curl -X POST http://83.166.238.230:3001/api/send-message \
  -H "Content-Type: application/json" \
  -d '{"phone":"+79001234567","message":"–¢–µ—Å—Ç"}'
```

### 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∏–∞–ª–æ–≥–æ–≤
```bash
curl http://83.166.238.230:3001/api/dialogs
```

### 4. –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
–û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:
- ‚úÖ –°—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–∏—Å–æ–≤ (–∑–µ–ª–µ–Ω—ã–µ –∫–∞—Ä—Ç–æ—á–∫–∏)
- ‚úÖ –§–æ—Ä–º–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ –°–ø–∏—Å–æ–∫ –¥–∏–∞–ª–æ–≥–æ–≤ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è
- ‚úÖ –ò—Å—Ç–æ—Ä–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è

---

## üêõ –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### "Gupshup API –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω"
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ GUPSHUP_API_KEY –≤ .env
- –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ webhook URL –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π

### "–¢–æ–∫–µ–Ω –¥–æ—Å—Ç—É–ø–∞ –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω"
- –ü—Ä–æ–π–¥–∏—Ç–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é —á–µ—Ä–µ–∑ /api/amo/auth
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ AMO_CLIENT_ID –∏ AMO_CLIENT_SECRET

### Webhook –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
- –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ —Å–µ—Ä–≤–µ—Ä –¥–æ—Å—Ç—É–ø–µ–Ω –∏–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ firewall (–ø–æ—Ä—Ç 3001 –æ—Ç–∫—Ä—ã—Ç)
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: `pm2 logs` –∏–ª–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏

### –°–æ–æ–±—â–µ–Ω–∏—è –Ω–µ –¥–æ—Ö–æ–¥—è—Ç
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å WhatsApp –Ω–æ–º–µ—Ä–∞ –≤ Gupshup
- –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –ø–æ–ª—É—á–∞—Ç–µ–ª—å opt-in

---

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### PM2 –∫–æ–º–∞–Ω–¥—ã
```bash
pm2 status                    # —Å—Ç–∞—Ç—É—Å –≤—Å–µ—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
pm2 logs whatsapp-amo-mvp    # –ª–æ–≥–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
pm2 monit                    # –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä
pm2 restart whatsapp-amo-mvp # –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫
```

### –õ–æ–≥–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
–í—Å–µ —Å–æ–±—ã—Ç–∏—è –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –≤ –∫–æ–Ω—Å–æ–ª—å:
- ‚úÖ –£—Å–ø–µ—à–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
- ‚ùå –û—à–∏–±–∫–∏ —Å –¥–µ—Ç–∞–ª—è–º–∏  
- üì§üì• –í—Ö–æ–¥—è—â–∏–µ/–∏—Å—Ö–æ–¥—è—â–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è
- üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤ amoCRM

**–ì–æ—Ç–æ–≤–æ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é!** üéâ
